<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JobZilla</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('https://images.unsplash.com/photo-1620131990732-7e7b04e6f04d?q=80&w=1600&auto=format&fit=crop') center/cover no-repeat, #f8f9fa;
      color: #333;
      margin: 0;
      scroll-behavior: smooth;
    }
    h1, h3 {
      font-family: 'Montserrat', sans-serif;
      letter-spacing: 0.5px;
      color: #333;
    }
    h1 { font-size: 2.5rem; }
    h3 { font-size: 1.8rem; }
    .navbar {
      background-color: #2b50ed;
      padding: 1rem 0;
    }
    .navbar-brand, .nav-link {
      color: #fff !important;
      transition: color 0.3s ease;
    }
    .nav-link:hover {
      color: #d1e7ff !important;
    }
    .nav-link.active {
      text-decoration: underline;
      text-underline-offset: 4px;
    }
    .container-white {
      background: linear-gradient(rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.95)), url('https://images.unsplash.com/photo-1617957681499-71734d151e29?q=80&w=1600&auto=format&fit=crop') center/cover no-repeat, #ffffff;
      border-radius: 0.75rem;
      box-shadow: 0 6px 16px rgba(0,0,0,0.1);
      padding: 2rem;
      margin-bottom: 2rem;
      animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .form-group {
      margin-bottom: 1.5rem;
    }
    .form-control, .form-select {
      font-size: 1.1rem;
      padding: 0.75rem;
    }
    .form-label {
      font-weight: 500;
    }
    .input-group-text {
      background-color: #f1f3f5;
    }
    .table {
      font-size: 0.95rem;
    }
    .table tbody tr {
      transition: background-color 0.2s ease;
      cursor: pointer;
    }
    .table tbody tr:hover {
      background-color: #f1f3f5;
    }
    .table tbody tr.selected {
      background-color: #e0e7ff;
    }
    .job-detail {
      background: #fff;
      padding: 1.5rem;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
    }
    .job-detail p {
      font-size: 1.1rem;
      padding: 0.5rem 0;
      border-bottom: 1px solid #e9ecef;
    }
    .job-detail p:last-child {
      border-bottom: none;
    }
    .action-btn {
      font-size: 0.9rem;
      margin-right: 0.5rem;
    }
    .back-to-top {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: none;
      z-index: 1000;
    }
    .btn {
      font-size: 1.1rem;
      transition: transform 0.2s ease, background-color 0.3s ease;
    }
    .btn:hover {
      transform: translateY(-2px);
    }
    .hybrid-location {
      display: none;
    }
    .custom-switch .custom-control-label Theresa: {
      background-color: #6c757d;
    }
    .custom-switch .custom-control-input:checked ~ .custom-control-label::before {
      background-color: #28a745;
    }
    .section {
      display: none;
    }
    .section.active {
      display: block;
    }
    .job-table-container {
      transition: all 0.3s ease;
    }
    .job-table-container.narrow {
      font-size: 0.85rem;
    }
    .job-table-container.narrow .table td, .job-table-container.narrow .table th {
      padding: 0.5rem;
    }
    .invalid-feedback {
      display: none;
      color: #dc3545;
      font-size: 0.9rem;
    }
    .is-invalid ~ .invalid-feedback {
      display: block;
    }
    .home-intro {
      font-size: 1.1rem;
      line-height: 1.6;
      color: #555;
      max-width: 800px;
      margin: 0 auto;
    }
    /* Chat Styles */
    .chat-box {
      height: 400px;
      overflow-y: auto;
      border: 1px solid #e9ecef;
      padding: 1rem;
      background: #fafafa;
      border-radius: 0.5rem;
      margin-bottom: 1rem;
    }
    .message {
      background: #e0f7fa;
      padding: 0.5rem 1rem;
      border-radius: 15px;
      margin-bottom: 0.75rem;
      max-width: 80%;
    }
    .message:nth-child(odd) {
      background: #fff3e0;
    }
    .guest {
      font-weight: 600;
      color: #2b50ed;
      margin-right: 0.5rem;
    }
    .message-timestamp {
      font-size: 0.8rem;
      color: #6c757d;
      margin-left: 0.5rem;
    }
    .chat-input-group .form-control {
      border-radius: 0.25rem 0 0 0.25rem;
    }
    .chat-input-group .btn {
      border-radius: 0 0.25rem 0.25rem 0;
    }
    @media (max-width: 768px) {
      body {
        background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('https://images.unsplash.com/photo-1620131990732-7e7b04e6f04d?q=80&w=800&auto=format&fit=crop') center/cover no-repeat, #f8f9fa;
      }
      .container-white {
        background: linear-gradient(rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.95)), url('https://images.unsplash.com/photo-1617957681499-71734d151e29?q=80&w=800&auto=format&fit=crop') center/cover no-repeat, #ffffff;
      }
      .job-table-container.narrow {
        font-size: 0.8rem;
      }
      .job-table-container.narrow .table td, .job-table-container.narrow .table th {
        padding: 0.4rem;
      }
      .job-detail {
        margin-top: 1rem;
      }
      .form-control, .btn {
        font-size: 1rem;
      }
      .table {
        font-size: 0.85rem;
      }
      .job-detail p {
        font-size: 1rem;
      }
      .home-intro {
        font-size: 1rem;
      }
      .chat-box {
        height: 300px;
      }
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg sticky-top">
    <div class="container">
      <a class="navbar-brand" href="#" onclick="showSection('home')">JobZilla</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link active" href="#" onclick="showSection('home')" aria-label="Home">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('post-job')" aria-label="Post Job">Post Job</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('view-jobs')" aria-label="View Jobs">View Jobs</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('post-resume')" aria-label="Post Resume">Post Resume</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('view-resumes')" aria-label="View Resumes">View Resumes</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('community-chat')" aria-label="Community Chat">Community Chat</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container my-4">
    <!-- Home Section -->
    <section id="home" class="section container-white text-center active">
      <h1 class="mb-4">Welcome to JobZilla</h1>
      <p class="lead mb-4">Where IT jobs roar and community chats soar!</p>
      <p class="mb-4 home-intro">Our platform empowers IT recruiters to post job opportunities and discover top talent, while enabling bench sales teams to showcase candidate resumes and connect with the right opportunities. Join our zany community to network and land your dream gig!</p>
      <div class="d-flex flex-wrap justify-content-center gap-3">
        <button class="btn btn-primary" onclick="showSection('post-job')" aria-label="Post a Job"><i class="bi bi-briefcase-fill me-2"></i>Post a Job</button>
        <button class="btn btn-success" onclick="showSection('post-resume')" aria-label="Post a Resume"><i class="bi bi-file-earmark-person-fill me-2"></i>Post a Resume</button>
        <button class="btn btn-info" onclick="showSection('view-jobs')" aria-label="View Jobs"><i class="bi bi-list-ul me-2"></i>View Jobs</button>
        <button class="btn btn-warning" onclick="showSection('view-resumes')" aria-label="View Resumes"><i class="bi bi-people-fill me-2"></i>View Resumes</button>
        <button class="btn btn-secondary" onclick="showSection('community-chat')" aria-label="Community Chat"><i class="bi bi-chat-dots-fill me-2"></i>Community Chat</button>
      </div>
    </section>

    <!-- Post Job Section -->
    <section id="post-job" class="section container-white">
      <h3 class="mb-4"><i class="bi bi-briefcase-fill me-2"></i>Post a Job</h3>
      <form id="jobForm">
        <div class="form-group">
          <label for="jobTitle" class="form-label">Job Title</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-briefcase"></i></span>
            <input type="text" class="form-control" id="jobTitle" required>
          </div>
        </div>
        <div class="form-group">
          <label for="technology" class="form-label">Technology</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-code-slash"></i></span>
            <input type="text" class="form-control" id="technology" placeholder="e.g., Python, JavaScript" required>
          </div>
        </div>
        <div class="form-group">
          <label for="location" class="form-label">Location</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-geo-alt"></i></span>
            <select class="form-control" id="location" required>
              <option value="">Select...</option>
              <option value="Alabama">Alabama</option>
              <option value="Alaska">Alaska</option>
              <option value="Arizona">Arizona</option>
              <option value="Arkansas">Arkansas</option>
              <option value="California">California</option>
              <option value="Colorado">Colorado</option>
              <option value="Connecticut">Connecticut</option>
              <option value="Delaware">Delaware</option>
              <option value="Florida">Florida</option>
              <option value="Georgia">Georgia</option>
              <option value="Hawaii">Hawaii</option>
              <option value="Idaho">Idaho</option>
              <option value="Illinois">Illinois</option>
              <option value="Indiana">Indiana</option>
              <option value="Iowa">Iowa</option>
              <option value="Kansas">Kansas</option>
              <option value="Kentucky">Kentucky</option>
              <option value="Louisiana">Louisiana</option>
              <option value="Maine">Maine</option>
              <option value="Maryland">Maryland</option>
              <option value="Massachusetts">Massachusetts</option>
              <option value="Michigan">Michigan</option>
              <option value="Minnesota">Minnesota</option>
              <option value="Mississippi">Mississippi</option>
              <option value="Missouri">Missouri</option>
              <option value="Montana">Montana</option>
              <option value="Nebraska">Nebraska</option>
              <option value="Nevada">Nevada</option>
              <option value="New Hampshire">New Hampshire</option>
              <option value="New Jersey">New Jersey</option>
              <option value="New Mexico">New Mexico</option>
              <option value="New York">New York</option>
              <option value="North Carolina">North Carolina</option>
              <option value="North Dakota">North Dakota</option>
              <option value="Ohio">Ohio</option>
              <option value="Oklahoma">Oklahoma</option>
              <option value="Oregon">Oregon</option>
              <option value="Pennsylvania">Pennsylvania</option>
              <option value="Rhode Island">Rhode Island</option>
              <option value="South Carolina">South Carolina</option>
              <option value="South Dakota">South Dakota</option>
              <option value="Tennessee">Tennessee</option>
              <option value="Texas">Texas</option>
              <option value="Utah">Utah</option>
              <option value="Vermont">Vermont</option>
              <option value="Virginia">Virginia</option>
              <option value="Washington">Washington</option>
              <option value="West Virginia">West Virginia</option>
              <option value="Wisconsin">Wisconsin</option>
              <option value="Wyoming">Wyoming</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label for="workMode" class="form-label">Work Mode</label>
          <select class="form-control" id="workMode" required>
            <option value="">Select...</option>
            <option value="On-site">On-site</option>
            <option value="Hybrid">Hybrid</option>
            <option value="Remote">Remote</option>
          </select>
        </div>
        <div class="form-group hybrid-location" id="hybridLocation">
          <label for="hybridLocationList" class="form-label">Hybrid Locations</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-geo-alt"></i></span>
            <input type="text" class="form-control" id="hybridLocationList" placeholder="e.g., New York, Texas">
          </div>
        </div>
        <div class="form-group">
          <label for="experienceRequired" class="form-label">Experience Required</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-clock"></i></span>
            <input type="text" class="form-control" id="experienceRequired" placeholder="e.g., 2-4 years" required>
          </div>
        </div>
        <div class="form-group">
          <label for="visaTypes" class="form-label">Required Visa Types</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-passport"></i></span>
            <input type="text" class="form-control" id="visaTypes" placeholder="e.g., H1B, F1 OPT, None" required>
            <div class="invalid-feedback">Please enter at least one visa type.</div>
          </div>
          <small class="form-text text-muted">Enter visa types separated by commas.</small>
        </div>
        <div class="form-group">
          <div class="custom-control custom-switch">
            <input type="checkbox" class="custom-control-input" id="f2fInterview" aria-label="Face-to-face interview required">
            <label class="custom-control-label" for="f2fInterview">Face-to-Face Interview Required?</label>
          </div>
        </div>
        <div class="form-group">
          <label for="recruiterEmail" class="form-label">Recruiter Email</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-envelope"></i></span>
            <input type="email" class="form-control" id="recruiterEmail" required pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$">
          </div>
        </div>
        <div class="form-group">
          <label for="recruiterPhone" class="form-label">Recruiter Phone Number</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-telephone"></i></span>
            <input type="tel" class="form-control" id="recruiterPhone" required pattern="^\(?(\d{3})\)?[- ]?(\d{3})[- ]?(\d{4})$" placeholder="(123) 456-7890">
            <div class="invalid-feedback">Enter a valid 10-digit USA phone number.</div>
          </div>
        </div>
        <div class="form-group">
          <label for="jobDescription" class="form-label">Job Description</label>
          <textarea class="form-control" id="jobDescription" rows="4" required></textarea>
        </div>
        <button type="submit" class="btn btn-primary" aria-label="Post Job">Post Job</button>
      </form>
    </section>

    <!-- View Jobs Section -->
    <section id="view-jobs" class="section container-white">
      <h3 class="mb-4"><i class="bi bi-list-ul me-2"></i>View Jobs</h3>
      <div class="input-group mb-3">
        <span class="input-group-text"><i class="bi bi-search"></i></span>
        <input type="text" id="jobSearch" class="form-control" placeholder="Search by title, technology, location, experience, or visa types" aria-label="Search jobs">
        <button class="btn btn-outline-secondary" onclick="resetJobSearch()" aria-label="Reset search">Reset</button>
        <button class="btn btn-outline-primary ms-2" onclick="refreshJobs()" aria-label="Refresh jobs"><i class="bi bi-arrow-repeat"></i> Refresh</button>
      </div>
      <div class="row">
        <div class="col-md-7 job-table-container" id="jobTableContainer">
          <div class="table-responsive">
            <table class="table table-hover" id="jobTable">
              <thead class="thead-dark">
                <tr>
                  <th scope="col">Posted</th>
                  <th scope="col">Job Title</th>
                  <th scope="col">Technology</th>
                  <th scope="col">Location</th>
                  <th scope="col">Experience</th>
                  <th scope="col">Visa Types</th>
                  <th scope="col">F2F Interview</th>
                  <th scope="col">Posted On</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
        <div class="col-md-5 job-detail" id="jobDetailContainer">
          <h4>Job Details</h4>
          <div id="jobDetailPanel">
            <p class="text-muted">Click a job to view details.</p>
          </div>
          <button class="btn btn-outline-secondary btn-sm mt-3 d-none" id="backButton" onclick="resetJobSelection()" aria-label="Back to job list">Back</button>
        </div>
      </div>
    </section>

    <!-- Post Resume Section -->
    <section id="post-resume" class="section container-white">
      <h3 class="mb-4"><i class="bi bi-file-earmark-person-fill me-2"></i>Post a Resume</h3>
      <form id="resumeForm">
        <div class="form-group">
          <label for="candidateName" class="form-label">Candidate Name</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-person"></i></span>
            <input type="text" class="form-control" id="candidateName" required>
          </div>
        </div>
        <div class="form-group">
          <label for="candidateSkills" class="form-label">Skills</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-code-slash"></i></span>
            <input type="text" class="form-control" id="candidateSkills" required>
          </div>
        </div>
        <div class="form-group">
          <label for="candidateExperience" class="form-label">Experience (years)</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-clock"></i></span>
            <input type="number" min="0" class="form-control" id="candidateExperience" required>
          </div>
        </div>
        <div class="form-group">
          <label for="candidatePhone" class="form-label">Candidate Phone Number (Optional)</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-telephone"></i></span>
            <input type="tel" class="form-control" id="candidatePhone" pattern="^\(?(\d{3})\)?[- ]?(\d{3})[- ]?(\d{4})$" placeholder="(123) 456-7890">
            <div class="invalid-feedback">Enter a valid 10-digit USA phone number.</div>
          </div>
        </div>
        <div class="form-group">
          <label for="visaStatus" class="form-label">Visa Status</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-passport"></i></span>
            <input type="text" class="form-control" id="visaStatus" required>
          </div>
        </div>
        <div class="form-group">
          <label for="resumeWorkMode" class="form-label">Preferred Work Mode</label>
          <select class="form-control" id="resumeWorkMode" required>
            <option value="">Select...</option>
            <option value="On-site">On-site</option>
            <option value="Hybrid">Hybrid</option>
            <option value="Remote">Remote</option>
          </select>
        </div>
        <div class="form-group hybrid-location" id="resumeHybridLocation">
          <label for="resumeHybridLocationList" class="form-label">Hybrid Locations</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-geo-alt"></i></span>
            <input type="text" class="form-control" id="resumeHybridLocationList" placeholder="e.g., New York, Texas">
          </div>
        </div>
        <div class="form-group">
          <label for="candidateResume" class="form-label">Upload Resume</label>
          <input type="file" class="form-control" id="candidateResume" accept=".pdf,.doc,.docx" required>
        </div>
        <button type="submit" class="btn btn-success" aria-label="Submit Resume">Submit Resume</button>
      </form>
    </section>

    <!-- View Resumes Section -->
    <section id="view-resumes" class="section container-white">
      <h3 class="mb-4"><i class="bi bi-people-fill me-2"></i>View Resumes</h3>
      <div class="input-group mb-3">
        <span class="input-group-text"><i class="bi bi-search"></i></span>
        <input type="text" id="resumeSearch" class="form-control" placeholder="Search by name, skills, experience, or phone" aria-label="Search resumes">
        <button class="btn btn-outline-secondary" onclick="resetResumeSearch()" aria-label="Reset search">Reset</button>
        <button class="btn btn-outline-primary ms-2" onclick="refreshResumes()" aria-label="Refresh resumes"><i class="bi bi-arrow-repeat"></i> Refresh</button>
      </div>
      <div class="table-responsive">
        <table class="table table-hover" id="resumeTable">
          <thead class="thead-dark">
            <tr>
              <th scope="col">Posted</th>
              <th scope="col">Name</th>
              <th scope="col">Skills</th>
              <th scope="col">Experience</th>
              <th scope="col">Phone</th>
              <th scope="col">Visa Status</th>
              <th scope="col">Actions</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- Community Chat Section -->
    <section id="community-chat" class="section container-white">
      <h3 class="mb-4"><i class="bi bi-chat-dots-fill me-2"></i>Community Chat</h3>
      <div class="chat-box" id="chat-box"></div>
      <div class="input-group chat-input-group">
        <input type="text" id="message-input" class="form-control" placeholder="Type your message..." aria-label="Chat message">
        <button class="btn btn-primary" id="send-btn" aria-label="Send message"><i class="bi bi-send-fill"></i> Send</button>
      </div>
    </section>
  </div>

  <button class="btn btn-primary back-to-top" onclick="scrollToTop()" aria-label="Back to top"><i class="bi bi-arrow-up"></i></button>

  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      console.log('DOM loaded, initializing JobZilla...');

      // DOM Elements
      const jobForm = document.getElementById('jobForm');
      const resumeForm = document.getElementById('resumeForm');
      const jobTable = document.getElementById('jobTable').getElementsByTagName('tbody')[0];
      const resumeTable = document.getElementById('resumeTable').getElementsByTagName('tbody')[0];
      const jobDetailPanel = document.getElementById('jobDetailPanel');
      const jobTableContainer = document.getElementById('jobTableContainer');
      const jobDetailContainer = document.getElementById('jobDetailContainer');
      const backButton = document.getElementById('backButton');
      const jobSearch = document.getElementById('jobSearch');
      const resumeSearch = document.getElementById('resumeSearch');
      const workMode = document.getElementById('workMode');
      const hybridLocationSection = document.getElementById('hybridLocation');
      const hybridLocationInput = document.getElementById('hybridLocationList');
      const resumeWorkMode = document.getElementById('resumeWorkMode');
      const resumeHybridLocationSection = document.getElementById('resumeHybridLocation');
      const resumeHybridLocationInput = document.getElementById('resumeHybridLocationList');
      const chatBox = document.getElementById('chat-box');
      const messageInput = document.getElementById('message-input');
      const sendBtn = document.getElementById('send-btn');

      // Initialize data
      let jobs = [];
      let resumes = [];
      let chatMessages = [];
      const animeNames = [
        "Naruto", "Sasuke", "Sakura", "Itachi", "Hinata", "Levi", "Eren", "Mikasa",
        "Luffy", "Zoro", "Nami", "Sanji", "Goku", "Vegeta", "Bulma", "Kakashi",
        "Killua", "Gon", "Hisoka", "Rem", "Light", "L", "Ichigo", "Rukia",
        "Asta", "Yuno", "Shoto", "Deku", "Bakugo", "Nezuko", "Tanjiro", "Inuyasha"
      ];
      const guestName = animeNames[Math.floor(Math.random() * animeNames.length)] + "_" + Math.floor(1000 + Math.random() * 9000);

      function loadInitialData() {
        try {
          jobs = JSON.parse(localStorage.getItem('jobs')) || [
            {
              timestamp: '2025-05-01 09:00:00',
              title: 'Data Scientist',
              technology: 'Python, SQL',
              location: 'California',
              workMode: 'Hybrid',
              hybridLocation: 'California, Texas',
              experienceRequired: '3-5 years',
              visaTypes: 'H1B, F1 OPT',
              f2fInterview: true,
              recruiterEmail: 'hr@abc.com',
              recruiterPhone: '1234567890',
              description: 'Analyze data trends.',
              postedOn: '2025-05-01'
            },
            {
              timestamp: '2025-04-25 14:30:00',
              title: 'Frontend Developer',
              technology: 'JavaScript, React',
              location: 'Texas',
              workMode: 'Remote',
              hybridLocation: 'N/A',
              experienceRequired: '2 years',
              visaTypes: 'None',
              f2fInterview: false,
              recruiterEmail: 'hr@xyz.com',
              recruiterPhone: '0987654321',
              description: 'Develop UIs.',
              postedOn: '2025-04-25'
            }
          ];
          resumes = JSON.parse(localStorage.getItem('resumes')) || [
            {
              timestamp: '2025-05-01 10:00:00',
              name: 'John Doe',
              skills: 'Python, SQL',
              experience: '3 years',
              phone: '1234567890',
              visaStatus: 'H1B',
              workMode: 'Remote',
              hybridLocation: 'N/A',
              resumeFile: 'john_doe_resume.pdf'
            },
            {
              timestamp: '2025-04-28 11:15:00',
              name: 'Jane Smith',
              skills: 'JavaScript, React',
              experience: '2 years',
              phone: '0987654321',
              visaStatus: 'OPT',
              workMode: 'Hybrid',
              hybridLocation: 'NY, TX',
              resumeFile: 'jane_smith_resume.pdf'
            }
          ];
          chatMessages = JSON.parse(localStorage.getItem('chatMessages')) || [];
          console.log('Initial data loaded:', { jobsCount: jobs.length, resumesCount: resumes.length, chatMessagesCount: chatMessages.length });
        } catch (e) {
          console.error('Error parsing initial localStorage data:', e);
          jobs = [];
          resumes = [];
          chatMessages = [];
        }
      }

      // Format phone number
      function formatPhoneNumber(phone) {
        if (!phone || phone === 'N/A') return 'N/A';
        const cleaned = ('' + phone).replace(/\D/g, '');
        const match = cleaned.match(/^(\d{3})(\d{3})(\d{4})$/);
        return match ? `(${match[1]}) ${match[2]}-${match[3]}` : phone;
      }

      // Show section
      window.showSection = function(id) {
        console.log('Showing section:', id);
        document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.nav-link').forEach(link => {
          link.classList.remove('active');
          if (link.onclick.toString().includes(id)) link.classList.add('active');
        });
        window.scrollTo({ top: 0, behavior: 'smooth' });
        if (id === 'community-chat') loadChatMessages();
        resetJobSelection();
      };

      // Work mode toggles
      workMode.addEventListener('change', function() {
        hybridLocationSection.style.display = this.value === 'Hybrid' ? 'block' : 'none';
        hybridLocationInput.required = this.value === 'Hybrid';
      });

      resumeWorkMode.addEventListener('change', function() {
        resumeHybridLocationSection.style.display = this.value === 'Hybrid' ? 'block' : 'none';
        resumeHybridLocationInput.required = this.value === 'Hybrid';
      });

      // Phone validation
      function validatePhoneInput(input) {
        const pattern = /^\(?(\d{3})\)?[- ]?(\d{3})[- ]?(\d{4})$/;
        if (input.value && !pattern.test(input.value)) {
          input.classList.add('is-invalid');
          return false;
        }
        input.classList.remove('is-invalid');
        return true;
      }

      document.getElementById('recruiterPhone').addEventListener('input', validatePhoneInput);
      document.getElementById('candidatePhone').addEventListener('input', validatePhoneInput);

      // Job form submission
      jobForm.addEventListener('submit', function(e) {
        e.preventDefault();
        console.log('Submitting job form...');
        const phoneInput = document.getElementById('recruiterPhone');
        const visaInput = document.getElementById('visaTypes');
        if (!validatePhoneInput(phoneInput)) return;
        if (!visaInput.value.trim()) {
          visaInput.classList.add('is-invalid');
          return;
        }
        visaInput.classList.remove('is-invalid');
        const job = {
          timestamp: new Date().toISOString().replace('T', ' ').substring(0, 19),
          title: document.getElementById('jobTitle').value,
          technology: document.getElementById('technology').value,
          location: document.getElementById('location').value,
          workMode: workMode.value,
          hybridLocation: workMode.value === 'Hybrid' ? hybridLocationInput.value : 'N/A',
          experienceRequired: document.getElementById('experienceRequired').value,
          visaTypes: visaInput.value.trim(),
          f2fInterview: document.getElementById('f2fInterview').checked,
          recruiterEmail: document.getElementById('recruiterEmail').value,
          recruiterPhone: phoneInput.value.replace(/\D/g, ''),
          description: document.getElementById('jobDescription').value,
          postedOn: new Date().toLocaleDateString()
        };
        jobs.push(job);
        try {
          localStorage.setItem('jobs', JSON.stringify(jobs));
          console.log('Job saved:', job);
        } catch (e) {
          console.error('Error saving job:', e);
        }
        jobForm.reset();
        workMode.value = '';
        hybridLocationSection.style.display = 'none';
        phoneInput.classList.remove('is-invalid');
        visaInput.classList.remove('is-invalid');
        loadJobs();
        alert('Job posted successfully!');
        showSection('view-jobs');
      });

      // Resume form submission
      resumeForm.addEventListener('submit', function(e) {
        e.preventDefault();
        console.log('Submitting resume form...');
        const phoneInput = document.getElementById('candidatePhone');
        if (phoneInput.value && !validatePhoneInput(phoneInput)) return;
        const resume = {
          timestamp: new Date().toISOString().replace('T', ' ').substring(0, 19),
          name: document.getElementById('candidateName').value,
          skills: document.getElementById('candidateSkills').value,
          experience: document.getElementById('candidateExperience').value + ' years',
          phone: phoneInput.value ? phoneInput.value.replace(/\D/g, '') : 'N/A',
          visaStatus: document.getElementById('visaStatus').value,
          workMode: resumeWorkMode.value,
          hybridLocation: resumeWorkMode.value === 'Hybrid' ? resumeHybridLocationInput.value : 'N/A',
          resumeFile: document.getElementById('candidateResume').value.split('\\').pop()
        };
        resumes.push(resume);
        try {
          localStorage.setItem('resumes', JSON.stringify(resumes));
          console.log('Resume saved:', resume);
        } catch (e) {
          console.error('Error saving resume:', e);
        }
        resumeForm.reset();
        resumeWorkMode.value = '';
        resumeHybridLocationSection.style.display = 'none';
        phoneInput.classList.remove('is-invalid');
        loadResumes();
        alert('Resume submitted successfully!');
        showSection('view-resumes');
      });

      // Load jobs
      function loadJobs() {
        console.log('Loading jobs...');
        try {
          jobs = JSON.parse(localStorage.getItem('jobs')) || jobs;
        } catch (e) {
          console.error('Error parsing jobs:', e);
          jobs = [];
        }
        jobs.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
        jobTable.innerHTML = '';
        jobs.forEach((job, index) => {
          const row = jobTable.insertRow();
          row.innerHTML = `
            <td>${job.timestamp}</td>
            <td>${job.title}</td>
            <td>${job.technology}</td>
            <td>${job.location}</td>
            <td>${job.experienceRequired}</td>
            <td>${job.visaTypes}</td>
            <td>${job.f2fInterview ? 'Yes' : 'No'}</td>
            <td>${job.postedOn}</td>
          `;
          row.dataset.index = index;
        });
        console.log('Jobs loaded:', jobs.length);
        attachJobRowListeners();
        resetJobSelection();
      }

      // Load resumes
      function loadResumes() {
        console.log('Loading resumes...');
        try {
          resumes = JSON.parse(localStorage.getItem('resumes')) || resumes;
        } catch (e) {
          console.error('Error parsing resumes:', e);
          resumes = [];
        }
        resumes.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
        resumeTable.innerHTML = '';
        resumes.forEach((resume, index) => {
          const row = resumeTable.insertRow();
          row.innerHTML = `
            <td>${resume.timestamp}</td>
            <td>${resume.name}</td>
            <td>${resume.skills}</td>
            <td>${resume.experience}</td>
            <td>${formatPhoneNumber(resume.phone)}</td>
            <td>${resume.visaStatus}</td>
            <td>
              <button class="btn btn-sm btn-primary action-btn" data-index="${index}" aria-label="View resume"><i class="bi bi-eye"></i></button>
              <button class="btn btn-sm btn-secondary action-btn" data-index="${index}" aria-label="Download resume"><i class="bi bi-download"></i></button>
            </td>
          `;
          row.dataset.index = index;
        });
        console.log('Resumes loaded:', resumes.length);
        attachActionButtonListeners();
      }

      // Job row listeners
      function attachJobRowListeners() {
        const rows = jobTable.getElementsByTagName('tr');
        Array.from(rows).forEach(row => {
          row.removeEventListener('click', handleJobRowClick);
          row.addEventListener('click', handleJobRowClick);
        });
      }

      function handleJobRowClick() {
        console.log('Job row clicked:', this.dataset.index);
        const rows = jobTable.getElementsByTagName('tr');
        Array.from(rows).forEach(row => row.classList.remove('selected'));
        this.classList.add('selected');
        jobTableContainer.classList.remove('col-md-7');
        jobTableContainer.classList.add('col-md-4', 'narrow');
        jobDetailContainer.classList.remove('col-md-5');
        jobDetailContainer.classList.add('col-md-8');
        backButton.classList.remove('d-none');
        const index = parseInt(this.dataset.index);
        const job = jobs[index];
        jobDetailPanel.innerHTML = job ?
          `<p><strong>Description:</strong> ${job.description}</p>
           <p><strong>Recruiter Email:</strong> ${job.recruiterEmail}</p>
           <p><strong>Recruiter Phone:</strong> ${formatPhoneNumber(job.recruiterPhone)}</p>` :
          `<p class="text-muted">Error loading job details.</p>`;
      }

      // Reset job selection
      window.resetJobSelection = function() {
        console.log('Resetting job selection...');
        const rows = jobTable.getElementsByTagName('tr');
        Array.from(rows).forEach(row => row.classList.remove('selected'));
        jobTableContainer.classList.remove('col-md-4', 'narrow');
        jobTableContainer.classList.add('col-md-7');
        jobDetailContainer.classList.remove('col-md-8');
        jobDetailContainer.classList.add('col-md-5');
        backButton.classList.add('d-none');
        jobDetailPanel.innerHTML = `<p class="text-muted">Click a job to view details.</p>`;
      };

      // Resume action buttons
      function attachActionButtonListeners() {
        document.querySelectorAll('.action-btn').forEach(btn => {
          btn.removeEventListener('click', handleActionButtonClick);
          btn.addEventListener('click', handleActionButtonClick);
        });
      }

      function handleActionButtonClick(e) {
        e.stopPropagation();
        console.log('Action button clicked:', this.dataset.index);
        const index = parseInt(this.dataset.index);
        const resume = resumes[index];
        if (!resume) {
          alert('Error: Resume not found.');
          return;
        }
        if (this.querySelector('.bi-eye')) {
          alert(`Viewing resume: ${resume.resumeFile}\nName: ${resume.name}\nSkills: ${resume.skills}\nExperience: ${resume.experience}\nPhone: ${formatPhoneNumber(resume.phone)}\nVisa Status: ${resume.visaStatus}\nWork Mode: ${resume.workMode}${resume.hybridLocation !== 'N/A' ? `\nHybrid Locations: ${resume.hybridLocation}` : ''}`);
        } else {
          alert(`Downloading resume: ${resume.resumeFile}`);
        }
      }

      // Job search
      jobSearch.addEventListener('input', function() {
        console.log('Job search input:', this.value);
        const searchQuery = this.value.toLowerCase();
        const rows = jobTable.getElementsByTagName('tr');
        Array.from(rows).forEach(row => {
          const index = parseInt(row.dataset.index);
          const job = jobs[index];
          if (!job) {
            row.style.display = 'none';
            return;
          }
          const title = job.title.toLowerCase();
          const technology = job.technology.toLowerCase();
          const location = job.location.toLowerCase();
          const experience = job.experienceRequired.toLowerCase();
          const visaTypes = job.visaTypes.toLowerCase();
          row.style.display = (title.includes(searchQuery) || technology.includes(searchQuery) || location.includes(searchQuery) || experience.includes(searchQuery) || visaTypes.includes(searchQuery)) ? '' : 'none';
        });
      });

      // Reset job search
      window.resetJobSearch = function() {
        console.log('Resetting job search...');
        jobSearch.value = '';
        loadJobs();
      };

      // Refresh jobs
      window.refreshJobs = function() {
        console.log('Refreshing jobs...');
        jobSearch.value = '';
        loadJobs();
      };

      // Resume search
      resumeSearch.addEventListener('input', function() {
        console.log('Resume search input:', this.value);
        const searchQuery = this.value.toLowerCase();
        const rows = resumeTable.getElementsByTagName('tr');
        Array.from(rows).forEach(row => {
          const index = parseInt(row.dataset.index);
          const resume = resumes[index];
          if (!resume) {
            row.style.display = 'none';
            return;
          }
          const name = resume.name.toLowerCase();
          const skills = resume.skills.toLowerCase();
          const experience = resume.experience.toLowerCase();
          const phone = resume.phone.toLowerCase();
          const visaStatus = resume.visaStatus.toLowerCase();
          row.style.display = (name.includes(searchQuery) || skills.includes(searchQuery) || experience.includes(searchQuery) || phone.includes(searchQuery) || visaStatus.includes(searchQuery)) ? '' : 'none';
        });
      });

      // Reset resume search
      window.resetResumeSearch = function() {
        console.log('Resetting resume search...');
        resumeSearch.value = '';
        loadResumes();
      };

      // Refresh resumes
      window.refreshResumes = function() {
        console.log('Refreshing resumes...');
        resumeSearch.value = '';
        loadResumes();
      };

      // Chat functionality
      function loadChatMessages() {
        console.log('Loading chat messages...');
        try {
          chatMessages = JSON.parse(localStorage.getItem('chatMessages')) || [];
        } catch (e) {
          console.error('Error parsing chat messages:', e);
          chatMessages = [];
        }
        chatBox.innerHTML = '';
        chatMessages.forEach(msg => {
          const messageElement = document.createElement('div');
          messageElement.className = 'message';
          messageElement.innerHTML = `<span class="guest">${msg.user}</span>: ${msg.text}<span class="message-timestamp">${msg.timestamp}</span>`;
          chatBox.appendChild(messageElement);
        });
        chatBox.scrollTop = chatBox.scrollHeight;
        console.log('Chat messages loaded:', chatMessages.length);
      }

      function sendMessage() {
        const message = messageInput.value.trim();
        if (!message) return;
        const msg = {
          user: guestName,
          text: message,
          timestamp: new Date().toLocaleTimeString()
        };
        chatMessages.push(msg);
        try {
          localStorage.setItem('chatMessages', JSON.stringify(chatMessages));
          console.log('Message saved:', msg);
        } catch (e) {
          console.error('Error saving message:', e);
        }
        const messageElement = document.createElement('div');
        messageElement.className = 'message';
        messageElement.innerHTML = `<span class="guest">${msg.user}</span>: ${msg.text}<span class="message-timestamp">${msg.timestamp}</span>`;
        chatBox.appendChild(messageElement);
        chatBox.scrollTop = chatBox.scrollHeight;
        messageInput.value = '';
      }

      sendBtn.addEventListener('click', sendMessage);
      messageInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') sendMessage();
      });

      // Back to top
      window.scrollToTop = function() {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      };

      window.addEventListener('scroll', () => {
        const btn = document.querySelector('.back-to-top');
        btn.style.display = window.scrollY > 300 ? 'block' : 'none';
      });

      // Initial load
      loadInitialData();
      loadJobs();
      loadResumes();
      showSection('home');
    });
  </script>
</body>
</html>